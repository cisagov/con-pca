<div class="p-3">
    <div class="d-flex flex-row mb-3">
        <div class="d-flex flex-grow-1 flex-column">
            <div class="d-flex flex-row mb-3">
                <button mat-raised-button color="primary" (click)="createNew()">Create New</button>
                <!-- <button mat-raised-button color="accent">Edit</button>
                <button mat-raised-button color="warn">Delete</button> -->
            </div>
            <div class="d-flex flex-row">
                <mat-form-field appearance="outline" class="flex-grow-1" [formGroup]="customerFormGroup">
                    <mat-label>Customer Name*</mat-label>
                    <input type="text" matInput placeholder="Customer/Organization Name" formControlName="customerName"
                    [errorStateMatcher]="matchCustomerName">
                    <mat-error *ngIf="customerFormGroup.controls.customerName.hasError('required')">
                    Customer/Organization name is <strong>required</strong>
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="d-flex flex-row" >
                <mat-form-field appearance="outline" class="flex-grow-1" [formGroup]="customerFormGroup">
                    <mat-label>Customer Identifier*</mat-label>
                    <input type="text" matInput placeholder="Customer/Organization Identifier" formControlName="customerIdentifier"
                    [errorStateMatcher]="matchCustomerIdentifier">
                    <mat-error *ngIf="customerFormGroup.controls.customerIdentifier.hasError('required')">
                    Customer/Organization identifier is <strong>required</strong>
                    </mat-error>
                </mat-form-field>
            </div>
            <!-- Place holder for Government Type -->
            <div class="d-flex flex-row" >
                <mat-form-field appearance="outline" class="flex-grow-1" [formGroup]="customerFormGroup">
                    <mat-label>Address 1*</mat-label>
                    <input type="text" matInput placeholder="Address 1" formControlName="address1"
                    [errorStateMatcher]="matchAddress1">
                    <mat-error *ngIf="customerFormGroup.controls.address1.hasError('required')">
                        Address 1 is <strong>required</strong>
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="d-flex flex-row">
                <mat-form-field appearance="outline" class="flex-grow-1" [formGroup]="customerFormGroup">
                    <mat-label>Address 2</mat-label>
                    <input type="text" matInput placeholder="Address 2" formControlName="address2">
                </mat-form-field>
            </div>
            <div class="d-flex flex-row">
                <mat-form-field appearance="outline" class="flex-grow-1" [formGroup]="customerFormGroup">
                    <mat-label>City*</mat-label>
                    <input type="text" matInput placeholder="city" formControlName="city"
                    [errorStateMatcher]="matchCity">
                    <mat-error *ngIf="customerFormGroup.controls.city.hasError('required')">
                        City is <strong>required</strong>
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="d-flex flex-row">
                <mat-form-field appearance="outline" class="flex-grow-1" [formGroup]="customerFormGroup">
                    <mat-label>State*</mat-label>
                    <input type="text" matInput placeholder="State" formControlName="state"
                    [errorStateMatcher]="matchState">
                    <mat-error *ngIf="customerFormGroup.controls.state.hasError('required')">
                        State is <strong>required</strong>
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="d-flex flex-row">
                <mat-form-field appearance="outline" class="flex-grow-1" [formGroup]="customerFormGroup">
                    <mat-label>Zip*</mat-label>
                    <input type="text" matInput placeholder="Zip" formControlName="zip"
                    [errorStateMatcher]="matchZip">
                    <mat-error *ngIf="customerFormGroup.controls.zip.hasError('required')">
                        Zip is <strong>required</strong>
                    </mat-error>
                </mat-form-field>
            </div>
        </div>
    </div>
    <h1>Customer/Organization Contacts</h1>
    <div class="d-flex flex-row mb-5">
        <div class="d-flex flex-grow-1 flex-column add-contact-width">
            <div class="d-flex flex-row">
                <button mat-raised-button color="primary" (click)="showAddContact()" *ngIf="!addContact">Add Contact/Organization</button>
            </div>
            
            <div class="d-flex flex-row p-2 flex-grow-1 add-contact-width" *ngIf="addContact">
                <mat-card class="add-contact-width">
                    <mat-card-header>
                        <mat-card-title>Add Contact</mat-card-title>
                    </mat-card-header>
                    <mat-card-content>
                        <div class="d-flex flex-row" >
                            <div class="d-flex flex-column mr-2 w-50" [formGroup]="contactFormGroup">
                                <mat-form-field appearance="outline">
                                    <mat-label>First Name*</mat-label>
                                    <input type="text" matInput placeholder="First Name" formControlName="firstName"
                                    [errorStateMatcher]="matchFirstName">
                                    <mat-error *ngIf="contactFormGroup.controls.firstName.hasError('required')">
                                        First name <strong>required</strong>
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="d-flex flex-column mr-2 w-50" [formGroup]="contactFormGroup">
                                <mat-form-field appearance="outline">
                                    <mat-label>Last Name*</mat-label>
                                    <input type="text" matInput placeholder="Last Name" formControlName="lastName"
                                    [errorStateMatcher]="matchLastName">
                                    <mat-error *ngIf="contactFormGroup.controls.lastName.hasError('required')">
                                        Last name <strong>required</strong>
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="d-flex flex-row">
                            <div class="d-flex flex-column mr-2 w-50" [formGroup]="contactFormGroup">
                                <mat-form-field appearance="outline">
                                    <mat-label>Title</mat-label>
                                    <input type="text" matInput placeholder="Title" formControlName="title">
                                </mat-form-field>
                            </div>
                            <div class="d-flex flex-column mr-2 w-50" [formGroup]="contactFormGroup">
                                <mat-form-field appearance="outline">
                                    <mat-label>Office Phone</mat-label>
                                    <input type="text" matInput placeholder="Office Phone" formControlName="office_phone">
                                </mat-form-field>
                            </div>
                            <div class="d-flex flex-column mr-2 w-50" [formGroup]="contactFormGroup">
                                <mat-form-field appearance="outline">
                                    <mat-label>Mobile Phone</mat-label>
                                    <input type="text" matInput placeholder="Mobile Phone" formControlName="mobile_phone">
                                </mat-form-field>
                            </div>
                           
                        </div>
                        <div class="d-flex flex-row">
                            <div class="d-flex flex-column mr-2 w-100" [formGroup]="contactFormGroup">
                                <mat-form-field appearance="outline">
                                    <mat-label>Email*</mat-label>
                                    <input type="text" matInput placeholder="Email" formControlName="email"
                                    [errorStateMatcher]="matchEmail">
                                    <mat-error *ngIf="contactFormGroup.controls.email.hasError('required')">
                                        Email <strong>required</strong>
                                    </mat-error>
                                    <mat-error *ngIf="contactFormGroup.controls.email.hasError('email')">
                                        Check email format
                                    </mat-error>
                                </mat-form-field>
                            </div>
                           
                        </div>
                        <div class="d-flex flex-row flex-grow-1 w-100" [formGroup]="contactFormGroup">
                            <mat-form-field appearance="outline" class="flex-grow-1">
                                <mat-label>Contact Notes</mat-label>
                                <textarea matInput formControlName="contactNotes"></textarea>
                            </mat-form-field>
                        </div>
                        <div class="d-flex flex-row flex-grow-1">
                            <div class="alert alert-danger flex-grow-1" *ngIf="contactError">
                                {{contactError}}
                            </div>
                        </div>
                        <button mat-raised-button color="primary" (click)="pushContact()" [disabled]="!contactFormGroup.valid">Add</button>
                        <button mat-flat-button (click)="showAddContact()">Close</button>
                    </mat-card-content>
                </mat-card>
            </div>
            <div class="d-flex flex-row flex-grow-1 mt-3 mb-3">
                <table mat-table [dataSource]="contacts" class="mat-elevation-z1 flex-grow-1" *ngIf="checkDataSourceLength()">                  
                    <!-- Name Column -->
                    <ng-container matColumnDef="name">
                      <th mat-header-cell *matHeaderCellDef> Name </th>
                      <td mat-cell *matCellDef="let element"> {{element.first_name + ' ' + element.last_name}} </td>
                    </ng-container>
                  
                    <!-- Title Column -->
                    <ng-container matColumnDef="title">
                      <th mat-header-cell *matHeaderCellDef> Title </th>
                      <td mat-cell *matCellDef="let element"> {{element.title}} </td>
                    </ng-container>
                  
                    <!-- Email Column -->
                    <ng-container matColumnDef="email">
                      <th mat-header-cell *matHeaderCellDef> Email </th>
                      <td mat-cell *matCellDef="let element"> {{element.email}} </td>
                    </ng-container>
                  
                    <!-- Mobile Phone Column -->
                    <ng-container matColumnDef="mobile_phone">
                      <th mat-header-cell *matHeaderCellDef> Mobile Phone </th>
                      <td mat-cell *matCellDef="let element"> {{element.mobile_phone}} </td>
                    </ng-container>
                  
                    <!-- Office Phone Column -->
                    <ng-container matColumnDef="office_phone">
                        <th mat-header-cell *matHeaderCellDef> Office Phone </th>
                        <td mat-cell *matCellDef="let element"> {{element.office_phone}} </td>
                      </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                  </table>
                  <div class="alert alert-danger flex-grow-1" role="alert" *ngIf="!checkDataSourceLength()">
                    No contacts Available
                  </div>
            </div>
            <div class="d-flex flex-row flex-grow-1">
                <div class="alert alert-danger flex-grow-1" *ngIf="orgError">
                    {{orgError}}
                </div>
            </div>
            <div class="d-flex flex-row flex-grow-1 justify-content-end">
                <button mat-raised-button color="primary" [disabled]="!customerFormGroup.valid" (click)="pushCustomer()">Save Customer</button>
                <button mat-flat-button (click)="cancelCustomer()">Cancel</button>
            </div>
        </div>
    </div>
</div>

